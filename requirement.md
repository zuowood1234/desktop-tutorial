# 股票短线交易助手需求文档

## 1. 项目概述
开发一个专注于 A 股市场的短线交易辅助网页应用。
系统利用 DeepSeek 大模型在回测模式下捕捉市场规律，每日根据最新行情为用户生成短线操作建议。
核心特色在于**量化维度的历史回测与资金收益模拟**，通过数据直观验证 AI 建议的盈利能力。

## 2. 核心功能

### 2.1 持仓录入与管理
*   **支持市场**：A 股（沪深主板/创业板/科创板）。
*   **输入项**：
    *   股票代码/名称
    *   持仓成本价
    *   持仓数量
    *   建仓日期
*   **资金账户**：
    *   设置初始回测资金（如：10万元），便于模拟真实账户变动。

### 2.2 智能建议系统 (DeepSeek驱动)
*   **数据源**：
    *   基础行情：开盘、收盘、最高、最低、成交量、换手率。
    *   技术指标：MA5/MA10/MA20 (均线), MACD, KDJ, RSI (相对强弱)。
    *   **大跌/大涨判定阈值**：
        *   大涨：涨幅 > 3%
        *   小涨：0% < 涨幅 <= 3%
        *   大跌：跌幅 < -3%
        *   小跌：-3% <= 跌幅 <= 0%
*   **分析逻辑**：
    *   Prompt 中需明确要求 DeepSeek 给出带有 **概率倾向** 的建议（如：强烈买入、谨慎持有）。
    *   输出不仅仅是方向，还包括对 **次日波动幅度** 的预判。

### 2.3 深度历史回测与收益计算 (核心)
*   **回测机制**：
    *   用户选择回测区间（如近 30 天）。
    *   系统逐日（T日）向 DeepSeek 发送 T日收盘数据，获取操作建议。
    *   **次日验证 (T+1日)**：
        *   根据 T+1日 实际开盘/收盘价，计算当日盈亏。
        *   **如果建议买入**：记录 T+1日 涨跌幅作为当日收益。
        *   **如果建议卖出/空仓**：当日收益为 0 (避险或踏空)。
*   **收益率计算**：
    *   **累计收益率**：整个回测区间的总盈亏比例。
    *   **最大回撤**：回测期间资产净值从最高点回落的最大幅度。
    *   **胜率统计**：建议买入后，次日确实上涨的天数占比。
    *   **盈亏比**：平均盈利金额 / 平均亏损金额。

### 2.4 数据存储与展示
*   **云端数据库**：
    *   用户持仓表 (Positions)。
    *   每日行情快照表 (Quotes)。
    *   AI建议历史表 (AdviceHistory)。
*   **前端展示**：
    *   **收益曲线图**：将“AI策略净值”与“基准（如沪深300）”进行对比。
    *   **详细交易日志**：列出每一笔 AI 建议的操作及其对应的次日实际盈亏金额。

## 3. 技术栈建议
*   **前端**：React / Vue (移动端优先，图表展示收益曲线)。
*   **后端**：Python (FastAPI) - 处理回测逻辑和金融数据计算。
*   **数据库**：PostgreSQL / Supabase。
*   **AI**：DeepSeek API。
*   **行情**：Tushare Pro / AkShare。
